schema: '2.0'
stages:
  preprocess:
    cmd: python rag_system/scripts/preprocess_data.py
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 287ee33d15312dd7b7a07e7e7131de0c
      size: 1874
      isexec: true
    - path: rag_system/data/raw
      hash: md5
      md5: f02866c744a2380601b240d2cd476565.dir
      size: 781847791
      nfiles: 6
    - path: rag_system/scripts/preprocess_data.py
      hash: md5
      md5: 4c1be93f535badf90a02899c96329aa8
      size: 27010
      isexec: true
    outs:
    - path: rag_system/data/processed/metadata.json
      hash: md5
      md5: 9cc309bcb97618630e1c17d93c12e21f
      size: 10998066
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: c9f99d24c1ee3ae23f90e34b23a1e848
      size: 1006955949
    - path: rag_system/data/processed/processing_stats.json
      hash: md5
      md5: 34c9b3d2963d7e499740ed070c65d133
      size: 321
  embed:
    cmd: python rag_system/retrieval/embedder.py
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 287ee33d15312dd7b7a07e7e7131de0c
      size: 1874
      isexec: true
    - path: rag_system/data/processed/metadata.json
      hash: md5
      md5: 4fa8e3d8a8bd339eaaf1d6e184155125
      size: 140503846
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: c9f99d24c1ee3ae23f90e34b23a1e848
      size: 1006955949
    - path: rag_system/retrieval/embedder.py
      hash: md5
      md5: 3c97a67a553e01498abbe085ba2ec779
      size: 21380
      isexec: true
    outs:
    - path: rag_system/data/processed/embedding_stats.json
      hash: md5
      md5: 14be52aec1d0f7bea816e0bf4cf108e2
      size: 36
    - path: rag_system/data/processed/embeddings
      hash: md5
      md5: a526c35db20e751ddea4dab481e4c12c.dir
      size: 2581238528
      nfiles: 6
  build_index:
    cmd: python rag_system/scripts/build_index.py
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 287ee33d15312dd7b7a07e7e7131de0c
      size: 1874
      isexec: true
    - path: rag_system/data/processed/embeddings
      hash: md5
      md5: a526c35db20e751ddea4dab481e4c12c.dir
      size: 2581238528
      nfiles: 6
    - path: rag_system/data/processed/metadata.json
      hash: md5
      md5: 9c0fb0c8debbb4ff73cd5ce23742b4cf
      size: 151266844
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: c9f99d24c1ee3ae23f90e34b23a1e848
      size: 1006955949
    - path: rag_system/scripts/build_index.py
      hash: md5
      md5: 296ede7fc8ca8c633c34d1cda5e4488d
      size: 7062
      isexec: true
    outs:
    - path: rag_system/retrieval/index/index.bin
      hash: md5
      md5: 522f61e3bad86157d86c7341e971d06b
      size: 2581237805
    - path: rag_system/retrieval/index/index_metadata.json
      hash: md5
      md5: 5759871d4d3330d4222c5b8c5a1bc5d3
      size: 74436776
  validate:
    cmd: python rag_system/retrieval/retriever.py --query "best anime like berserk
      recommendation" --top_k 5
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 287ee33d15312dd7b7a07e7e7131de0c
      size: 1874
      isexec: true
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: c9f99d24c1ee3ae23f90e34b23a1e848
      size: 1006955949
    - path: rag_system/retrieval/index/index.bin
      hash: md5
      md5: 522f61e3bad86157d86c7341e971d06b
      size: 2581237805
    - path: rag_system/retrieval/index/index_metadata.json
      hash: md5
      md5: 5759871d4d3330d4222c5b8c5a1bc5d3
      size: 74436776
    - path: rag_system/retrieval/retriever.py
      hash: md5
      md5: 9824ed4df66e234f65f8754f80226aee
      size: 29892
      isexec: true
